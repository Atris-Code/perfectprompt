Documento: 1. El _Ranking de Estilos__ ¿Qué estética prefiere tu equipo_.pdf
================================================================================


--- Página 1 ---
Aquí
 
tienes
 
las
 
consultas
 
SQL
 
precisas
 
para
 
extraer
 
la
 
inteligencia
 
de
 
negocio
 
de
 
tu
 
base
 
de
 
datos.
 
Para
 
visualizar
 
la
 
"Tasa
 
de
 
Éxito",
 
necesitamos
 
extraer
 
datos
 
del
 
JSONB
 
(
engine_config
)
 
y
 
cruzarlos
 
con
 
los
 
sentimientos
 
de
 
la
 
tabla
 
de
 
feedback.
 
Te
 
propongo
 
dos
 
enfoques:
 
una
 
Visión
 
General
 
por
 
Estilo
 
(para
 
comparar
 
qué
 
estética
 
funciona
 
mejor)
 
y
 
una
 
Evolución
 
Temporal
 
(para
 
ver
 
si
 
la
 
IA
 
está
 
mejorando).
 
 
1.
 
El
 
"Ranking
 
de
 
Estilos":
 
¿Qué
 
estética
 
prefiere
 
tu
 
equipo?
 
Esta
 
consulta
 
es
 
ideal
 
para
 
un
 
Gráfico
 
de
 
Barras
.
 
Compara
 
los
 
diferentes
 
presets
 
visuales
 
(Cyberpunk,
 
Ingeniero,
 
Inversor)
 
y
 
calcula
 
su
 
tasa
 
de
 
aprobación.
 
SQL
 
SELECT
 
 
    
--
 
1.
 
Extraemos
 
el
 
estilo
 
del
 
JSONB
 
sin
 
las
 
comillas
 
(->>)
 
    
gen.engine_config
 
->>
 
'style_preset'
 
AS
 
estilo_visual,
 
    
 
    
--
 
2.
 
Métricas
 
Totales
 
    
COUNT(gen.id)
 
AS
 
total_generaciones,
 
    
 
    
--
 
3.
 
Conteo
 
de
 
Votos
 
(Pivotando
 
los
 
datos)
 
    
SUM(CASE
 
WHEN
 
fb.sentiment
 
=
 
'POSITIVE'
 
THEN
 
1
 
ELSE
 
0
 
END)
 
AS
 
likes,
 
    
SUM(CASE
 
WHEN
 
fb.sentiment
 
=
 
'NEGATIVE'
 
THEN
 
1
 
ELSE
 
0
 
END)
 
AS
 
dislikes,
 
    
SUM(CASE
 
WHEN
 
fb.sentiment
 
IS
 
NULL
 
THEN
 
1
 
ELSE
 
0
 
END)
 
AS
 
sin_feedback,
 
 
    
--
 
4.
 
Cálculo
 
de
 
la
 
Tasa
 
de
 
Éxito
 
(Excluyendo
 
los
 
'sin
 
feedback'
 
para
 
ser
 
justos)
 
    
--
 
Fórmula:
 
(Positivos
 
/
 
(Positivos
 
+
 
Negativos))
 
*
 
100
 
    
ROUND(
 
        
(SUM(CASE
 
WHEN
 
fb.sentiment
 
=
 
'POSITIVE'
 
THEN
 
1
 
ELSE
 
0
 
END)::numeric
 
/
 
 
        
NULLIF(SUM(CASE
 
WHEN
 
fb.sentiment
 
IN
 
('POSITIVE',
 
'NEGATIVE')
 
THEN
 
1
 
ELSE
 
0
 
END),
 
0))
 
*
 
100,
 
 
    
2)
 
AS
 
tasa_aprobacion_pct
 
 
FROM
 
ai_generations
 
gen
 
LEFT
 
JOIN
 
ai_feedback
 
fb
 
ON
 
gen.id
 
=
 
fb.generation_id
 
WHERE
 
gen.created_at
 
>=
 
NOW()
 
-
 
INTERVAL
 
'30
 
days'
 
--
 
Últimos
 
30
 
días
 
GROUP
 
BY
 
1
 
HAVING
 
COUNT(gen.id)
 
>
 
5
 
--
 
Filtramos
 
estilos
 
con
 
pocas
 
pruebas
 
para
 
evitar
 
ruido
 
ORDER
 
BY
 
tasa_aprobacion_pct
 
DESC
 
NULLS
 
LAST;
 
 
--- Página 2 ---
¿Qué
 
nos
 
dice
 
esta
 
tabla?
 
Si
 
el
 
estilo
 
CYBERPUNK_DARK
 
tiene
 
un
 
85%
 
de
 
aprobación
 
y
 
el
 
MINIMALIST_WHITE
 
tiene
 
un
 
40%
,
 
sabrás
 
científicamente
 
que
 
debes
 
configurar
 
tu
 
VisualMetaphorEngine
 
para
 
priorizar
 
el
 
estilo
 
oscuro
 
por
 
defecto.
 
 
2.
 
La
 
"Línea
 
de
 
Salud":
 
Evolución
 
de
 
Calidad
 
en
 
el
 
Tiempo
 
Esta
 
consulta
 
alimenta
 
un
 
Gráfico
 
de
 
Línea
.
 
Muestra
 
si
 
tus
 
ajustes
 
en
 
los
 
prompts
 
(el
 
refinamiento
 
que
 
haces
 
en
 
el
 
backend)
 
están
 
mejorando
 
la
 
satisfacción
 
del
 
usuario
 
semana
 
a
 
semana.
 
SQL
 
SELECT
 
 
    
--
 
Agrupamos
 
por
 
semana
 
    
DATE_TRUNC('week',
 
gen.created_at)::date
 
AS
 
semana,
 
    
 
    
COUNT(gen.id)
 
AS
 
volumen_generado,
 
    
 
    
--
 
Tasa
 
de
 
Rechazo
 
(Quejas
 
/
 
Total
 
con
 
Feedback)
 
    
ROUND(
 
        
(SUM(CASE
 
WHEN
 
fb.sentiment
 
=
 
'NEGATIVE'
 
THEN
 
1
 
ELSE
 
0
 
END)::numeric
 
/
 
 
        
NULLIF(COUNT(fb.id),
 
0))
 
*
 
100,
 
 
    
2)
 
AS
 
tasa_rechazo_pct,
 
 
    
--
 
Análisis
 
de
 
Causa
 
Raíz
 
(Extraemos
 
el
 
tag
 
de
 
error
 
más
 
común
 
de
 
la
 
semana)
 
    
--
 
Esto
 
usa
 
una
 
sub-agregación
 
de
 
arrays
 
en
 
PostgreSQL
 
    
(
 
        
SELECT
 
mode()
 
WITHIN
 
GROUP
 
(ORDER
 
BY
 
tag)
 
        
FROM
 
(
 
            
SELECT
 
unnest(tags)
 
AS
 
tag
 
 
            
FROM
 
ai_feedback
 
f2
 
 
            
WHERE
 
f2.generation_id
 
IN
 
(
 
                
SELECT
 
id
 
FROM
 
ai_generations
 
g2
 
 
                
WHERE
 
DATE_TRUNC('week',
 
g2.created_at)
 
=
 
DATE_TRUNC('week',
 
gen.created_at)
 
            
)
 
        
)
 
sub
 
    
)
 
AS
 
error_mas_comun
 
 
FROM
 
ai_generations
 
gen
 
LEFT
 
JOIN
 
ai_feedback
 
fb
 
ON
 
gen.id
 
=
 
fb.generation_id
 
GROUP
 
BY
 
1
 
ORDER
 
BY
 
1
 
ASC;
 
--- Página 3 ---
 
Interpretación
 
del
 
Resultado:
 
●
 
Semana
 
1:
 
Tasa
 
rechazo
 
40%.
 
Error
 
común:
 
TOO_DARK
.
 
●
 
(Haces
 
un
 
cambio
 
en
 
el
 
código
 
Python
 
para
 
añadir
 
luces)
.
 
●
 
Semana
 
2:
 
Tasa
 
rechazo
 
15%.
 
Error
 
común:
 
TEXT_GLITCH
.
 
Esto
 
te
 
permite
 
correlacionar
 
tus
 
despliegues
 
de
 
código
 
con
 
la
 
satisfacción
 
del
 
usuario
 
real.
 
 
3.
 
Integración
 
en
 
tu
 
Dashboard
 
(Frontend)
 
Para
 
mostrar
 
esto
 
en
 
tu
 
interfaz
 
React/Vue,
 
el
 
endpoint
 
de
 
tu
 
API
 
devolvería
 
un
 
JSON
 
así
 
basado
 
en
 
la
 
Consulta
 
1:
 
JSON
 
{
 
  
"chart_data":
 
{
 
    
"labels":
 
["Cyberpunk
 
Dark",
 
"Ingeniería
 
Azul",
 
"Inversor
 
Gold"],
 
    
"datasets":
 
[
 
      
{
 
        
"label":
 
"Tasa
 
de
 
Aprobación
 
(%)",
 
        
"data":
 
[85.5,
 
62.0,
 
45.2],
 
        
"backgroundColor":
 
["#00D4FF",
 
"#6875F5",
 
"#F59E0B"],
 
//
 
Tus
 
colores
 
corporativos
 
        
"borderColor":
 
"#1E293B",
 
        
"borderWidth":
 
2
 
      
}
 
    
]
 
  
},
 
  
"insight_text":
 
"El
 
estilo
 
'Cyberpunk
 
Dark'
 
supera
 
a
 
todos
 
los
 
demás
 
con
 
un
 
85%
 
de
 
éxito.
 
Considere
 
hacerlo
 
el
 
default
 
para
 
todos
 
los
 
usuarios."
 
}
 
 